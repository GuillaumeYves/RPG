  <div class="mt-5" style="display: flex; flex-direction: row; ">
    <div class="card text-left " style="border: 2px solid #000; box-shadow: 5px 5px 10px #888888; padding: 30px; max-height: 700px; max-width: 500px; margin-right: 20px;">
      <div class="card-body">
        <div style="position: relative; max-width: 100%;">
          <%= image_tag('npcs/merchant.jpg', style: 'max-width:100%; height:auto; border: 5px solid #000; box-shadow: 2px 2px 10px #888888;', class: 'card-img-top', alt: "character_image") %>
          <h5 style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); color: white; font-size: 24px; font-weight: bold; text-shadow: -2px -2px 2px #000, 2px -2px 2px #000, -2px 2px 2px #000, 2px 2px 2px #000; width: 90%; text-align: center;">Mysterious Merchant</h5>
        </div>
        <br>
        <p class="card-text">Welcome adventurer... 
        <br>  
        May I interest you in some of my fine wares?
        </p>
      </div>
    </div>


    <div style="flex-row">
      <div class="mb-5">
        <div class="mx-auto">
          <% if current_user.present? && @selected_character.user_id == current_user.id && current_user.selected_character.present? && current_user.selected_character.id == @selected_character.id %>
            <!-- Inventory card -->
            <%= render partial: 'characters/inventory', locals: { character: @selected_character } %>
          <% end %>
        </div>
      </div>

      <div class="card text-left mb-1" style="width: 800px; height: auto; border: 2px solid #000; box-shadow: 5px 5px 10px #888888;">
        <div class="card-body">
          <h4 class="card-header text-center text-white bg-primary" style="width: 200px; margin: 0 auto; margin-bottom: 20px;">Weapons</h4>
            <div class="merchant-grid" style="display: grid; grid-template-columns: repeat(5, 1fr);">
              <% @random_weapon_items.each do |item| %>
                  <div class="merchant-item text-center item-tooltip" onmousemove="updateTooltipPosition(event, <%= item.id %>)" onmouseover="showTooltip(<%= item.id %>, 'Weapon')" onmouseout="hideTooltip(<%= item.id %>)">
                    <% if item %>
                      <%= display_item_tooltip(item) %>
                      <%= image_tag(item.item_image, style: 'width: 100px; height: 100px; border: 2px solid #000; box-shadow: 2px 2px 10px #888888;') %>
                      <%= button_to "Purchase", add_to_inventory_character_path(@selected_character, item_id: item.id), method: :post, class: "btn btn-outline-primary btn-sm mt-1 mb-1", id: "purchaseButton#{item.id}" %>
                      <script>
                        // JavaScript code to show gold price on hover
                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseover', function() {
                          this.innerText = '- <%= number_with_delimiter(item.gold_price) %>';
                        });

                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseout', function() {
                          this.innerText = 'Purchase';
                        });
                      </script>
                    <% end %>
                  </div>
              <% end %>
            </div>
        </div>
      </div>

      <div class="card text-left mb-1" style="width: 800px; height: auto; border: 2px solid #000; box-shadow: 5px 5px 10px #888888;">
        <div class="card-body">
          <h4 class="card-header text-center text-white bg-primary" style="width: 200px; margin: 0 auto; margin-bottom: 20px;">Armor</h4>
            <div class="merchant-grid" style="display: grid; grid-template-columns: repeat(5, 1fr);">
              <% @random_armor_items.each do |item| %>
                  <div class="merchant-item text-center item-tooltip" onmousemove="updateTooltipPosition(event, <%= item.id %>)" onmouseover="showTooltip(<%= item.id %>, 'Armor')" onmouseout="hideTooltip(<%= item.id %>)">
                    <% if item %>
                      <%= display_item_tooltip(item) %>
                      <%= image_tag(item.item_image, style: 'width: 100px; height: 100px; border: 2px solid #000; box-shadow: 2px 2px 10px #888888;') %>
                      <%= button_to "Purchase", add_to_inventory_character_path(@selected_character, item_id: item.id), method: :post, class: "btn btn-outline-primary btn-sm mt-1 mb-1", id: "purchaseButton#{item.id}" %>
                      <script>
                        // JavaScript code to show gold price on hover
                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseover', function() {
                          this.innerText = '- <%= number_with_delimiter(item.gold_price) %>';
                        });

                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseout', function() {
                          this.innerText = 'Purchase';
                        });
                      </script>
                    <% end %>
                  </div>
              <% end %>
            </div>
        </div>
      </div>

      <div class="card text-left" style="width: 800px; height: auto; border: 2px solid #000; box-shadow: 5px 5px 10px #888888;">
        <div class="card-body">
          <h4 class="card-header text-center text-white bg-primary" style="width: 200px; margin: 0 auto; margin-bottom: 20px;">Jewelry</h4>
            <div class="merchant-grid" style="display: grid; grid-template-columns: repeat(5, 1fr);">
              <% @random_jewelry_items.each do |item| %>
                  <div class="merchant-item text-center item-tooltip" onmousemove="updateTooltipPosition(event, <%= item.id %>)" onmouseover="showTooltip(<%= item.id %>, 'Jewelry')" onmouseout="hideTooltip(<%= item.id %>)">
                    <% if item %>
                      <%= display_item_tooltip(item) %>
                      <%= image_tag(item.item_image, style: 'width: 100px; height: 100px; border: 2px solid #000; box-shadow: 2px 2px 10px #888888;') %>
                      <%= button_to "Purchase", add_to_inventory_character_path(@selected_character, item_id: item.id), method: :post, class: "btn btn-outline-primary btn-sm mt-1 mb-1", id: "purchaseButton#{item.id}" %>
                      <script>
                        // JavaScript code to show gold price on hover
                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseover', function() {
                          this.innerText = '- <%= number_with_delimiter(item.gold_price) %>';
                        });

                        document.getElementById('purchaseButton<%= item.id %>').addEventListener('mouseout', function() {
                          this.innerText = 'Purchase';
                        });
                      </script>
                    <% end %>
                  </div>
              <% end %>
            </div>
        </div>
      </div>

    </div>
  </div>


<script>
  function showTooltip(itemId, itemType) {
    const tooltip = document.getElementById(`tooltip_${itemId}`);
    if (tooltip) tooltip.style.display = 'block';
  }

  function hideTooltip(itemId) {
    const tooltip = document.getElementById(`tooltip_${itemId}`);
    if (tooltip) tooltip.style.display = 'none';
  }

  function updateTooltipPosition(event, itemId) {
    const tooltip = document.getElementById(`tooltip_${itemId}`);
    const offset = 10;
    const x = event.clientX + offset;
    const y = event.clientY + offset;

    // Check if the cursor is in the bottom half of the page
    const isBottomHalf = event.clientY > window.innerHeight / 2;

    // Adjust the tooltip position based on the cursor's location
    if (isBottomHalf) {
      tooltip.style.left = `${x}px`;
      tooltip.style.bottom = `${window.innerHeight - y}px`;
      tooltip.style.top = ''; // Reset top property
    } else {
      tooltip.style.left = `${x}px`;
      tooltip.style.top = `${y}px`;
      tooltip.style.bottom = ''; // Reset bottom property
    }
  }
</script>